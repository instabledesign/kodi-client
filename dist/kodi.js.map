{"version":3,"file":"kodi.js","sources":["../src/KodiRequest.js","../src/KodiClient.js","../src/KodiClientRPC.js","../src/KodiNotification.js","../src/KodiResponse.js","../src/transport/KodiWebSocketTransport.js","../src/transport/KodiXMLHttpTransport.js","../src/notificationMiddleware/logging.js","../src/notificationMiddleware/stackFactory.js","../src/middleware/logging.js","../src/middleware/cache.js","../src/middleware/stackFactory.js","../src/cache/InMemory.js","../src/cache/LocalStorage.js","../src/cache/withTTL.js","../src/KodiClientFactory.js"],"sourcesContent":["const JSONRPC_VERSION = '2.0';\n\nfunction KodiRequest(id, options) {\n    if (!(this instanceof KodiRequest)) {\n        return new KodiRequest(id, options);\n    }\n\n    if (options && 'object' !== Object.prototype.toString.call(options).split(\" \").pop().split(\"]\").shift().toLowerCase()) {\n        throw new TypeError('Options must be an object.');\n    }\n\n    this.id = id;\n\n    ({\n        method: this.method,\n        params: this.params,\n        jsonrpc: this.jsonrpc = JSONRPC_VERSION\n    } = options || {});\n}\n\nKodiRequest.prototype.toJson = function() {\n    return JSON.stringify({\n        id: this.id,\n        jsonrpc: this.jsonrpc,\n        method: this.method,\n        params: this.params\n    });\n};\n\nexport default KodiRequest;","import KodiRequest from './KodiRequest.js';\n\nfunction KodiClient(handler, notifier) {\n    if (!(this instanceof KodiClient)) {\n        return new KodiClient(handler, notifier);\n    }\n\n    let listeners = [];\n\n    // default factory\n    let factory = (() => {\n        let requestId = 1;\n        return options => new KodiRequest(requestId++, options)\n    })();\n\n    KodiClient.prototype.factory = newFactory =>  {\n        factory = newFactory;\n\n        return this;\n    };\n\n    notifier((notification, messageEvent) => {\n        listeners.forEach(callback => callback(notification, messageEvent));\n    });\n\n    KodiClient.prototype.send = (request, options) => handler.call(handler, request, options);\n\n    KodiClient.prototype.request = (method, params, options) => this.send(factory.call(factory, {method, params}), options);\n\n    KodiClient.prototype.addNotificationListener = function(listener) {\n        const index = listeners.push(listener);\n\n        return () => {\n            delete listeners[index];\n        };\n    };\n\n    KodiClient.prototype.removeNotificationListener = function(listener) {\n        listeners = listeners.filter(currentListener => currentListener === listener);\n    };\n}\n\nexport default KodiClient;","import KodiClient from './KodiClient.js';\n\nfunction KodiClientRPC(kodiClient) {\n    if (!(this instanceof KodiClientRPC)) {\n        return new KodiClientRPC(kodiClient);\n    }\n\n    if (!(kodiClient instanceof KodiClient)) {\n        throw new TypeError('It must be a KodiClient.');\n    }\n\n    let schema = null;\n    let listeners = {};\n\n    this.onReady = new Promise((resolve, reject) => {\n        kodiClient.request('JSONRPC.Introspect', {\"getdescriptions\": true, \"getmetadata\": true, \"filterbytransport\": true}).then(data => {\n            schema = data.result;\n\n            const methods = schema.methods;\n            for (const name in methods) {\n                let [namespace, method] = name.split('.');\n                if (!this[namespace]) {\n                    this[namespace] = {};\n                }\n                this[namespace][method] = (params, options) => {\n                    return kodiClient.request(name, params, options).then(response => response.result);\n                };\n            }\n\n            const notifications = schema.notifications;\n\n            for (const name in notifications) {\n                let [namespace, notification] = name.split('.');\n                if (!this[namespace]) {\n                    this[namespace] = {};\n                }\n                this[namespace][notification] = callback => {\n                    if (!listeners[`${namespace}.${notification}`]) listeners[`${namespace}.${notification}`] = [];\n                    listeners[`${namespace}.${notification}`].push(callback);\n                };\n            }\n\n            kodiClient.addNotificationListener((notification, messageEvent) => {\n                if (listeners.hasOwnProperty(notification.method)) {\n                    listeners[notification.method].forEach(callback => callback(notification.params, messageEvent));\n                }\n            });\n\n            resolve([this, schema]);\n\n        }).catch(reject);\n    });\n}\n\nexport default KodiClientRPC;\n","function KodiNotification(data) {\n    if (!(this instanceof KodiNotification)) {\n        return new KodiNotification(data);\n    }\n\n    Object.assign(this, data);\n}\n\nexport default KodiNotification;","function KodiResponse(data) {\n    if (!(this instanceof KodiResponse)) {\n        return new KodiResponse(data);\n    }\n\n    if (data && 'object' !== Object.prototype.toString.call(data).split(\" \").pop().split(\"]\").shift().toLowerCase()) {\n        throw new TypeError('Data must be an object.');\n    }\n\n    Object.assign(this, data);\n}\n\nexport default KodiResponse;","import KodiNotification from '../KodiNotification.js';\nimport KodiResponse from '../KodiResponse.js';\n\nfunction KodiWebSocketTransport(uri) {\n    if (!(this instanceof KodiWebSocketTransport)) {\n        return new KodiWebSocketTransport(uri);\n    }\n\n    let deferreds = {};\n    let listeners = [];\n    let websocket;\n    let onReady = this.onReady = new Promise((resolve, reject) => {\n        websocket = new WebSocket(uri);\n        websocket.onerror = reject;\n        websocket.onopen = function(event) {\n            this.onmessage = messageEvent => {\n                const messageData = JSON.parse(messageEvent.data);\n                if (null === messageData.id) {\n                    console.error(messageEvent);\n\n                    return;\n                }\n                if (messageData.id) {\n                    const response = new KodiResponse(messageData);\n                    response.error ?\n                        deferreds[response.id].deferredReject(response) :\n                        deferreds[response.id].deferredResolve(response);\n\n                    return;\n                }\n\n                const notification = new KodiNotification(messageData);\n                listeners.forEach(callback => callback(notification, messageEvent));\n            };\n            resolve(event);\n        };\n    });\n\n    KodiWebSocketTransport.prototype.send = function(request, options) {\n        if (!request.id) {\n            throw new TypeError('Request id is require.');\n        }\n\n        let deferredResolve;\n        let deferredReject;\n        const promise = new Promise(function(resolve, reject) {\n            deferredResolve = resolve;\n            deferredReject = reject;\n\n            try {\n                onReady.then(() => websocket.send(request.toJson()));\n            } catch (error) {\n                deferredReject(new KodiResponse({message: 'An error occured during sending message.', error: error}));\n            }\n        });\n\n        deferreds[request.id] = { promise, deferredResolve, deferredReject };\n\n        return promise;\n    };\n\n    KodiWebSocketTransport.prototype.addNotificationListener = function(listener) {\n        const index = listeners.push(listener);\n\n        return () => {\n            delete listeners[index];\n        };\n    };\n\n    KodiWebSocketTransport.prototype.removeNotificationListener = function(listener) {\n        listeners = listeners.filter(currentListener => currentListener === listener);\n    };\n}\n\nexport default KodiWebSocketTransport;","import KodiResponse from '../KodiResponse.js';\n\nfunction KodiXMLHttpTransport(uri) {\n    if (!(this instanceof KodiXMLHttpTransport)) {\n        return new KodiXMLHttpTransport(uri);\n    }\n\n    KodiXMLHttpTransport.prototype.send = function (request, options) {\n        return new Promise((resolve, reject) => {\n            const req = new XMLHttpRequest();\n            req.onreadystatechange = function(event) {\n                if (this.readyState === XMLHttpRequest.DONE) {\n                    if (this.status === 200) {\n                        const response = new KodiResponse(JSON.parse(this.responseText));\n                        response.error ? reject(response) : resolve(response);\n                    } else {\n                        reject(new KodiResponse({message: this.statusText, error: this}));\n                    }\n                }\n            };\n\n            req.open('GET', uri + '?request=' + request.toJson(), true);\n            req.send(null);\n        });\n    };\n\n    KodiXMLHttpTransport.prototype.addNotifiable = function (request, options) {};\n}\n\n\nexport default KodiXMLHttpTransport;","export default callback => (notification, messageEvent) => {\n    console.log('Notification %o.', notification, messageEvent);\n\n    callback(notification, messageEvent);\n}","export default (notifier, middlewares) => callback => notifier(\n    middlewares.reverse().reduce(\n        (prev, cur) => null === prev ? cur : cur(prev),\n        callback\n    )\n);\n","export default handler => (request, options) => {\n    console.log('Request %o', request);\n    const startTime = Date.now();\n\n    return handler(request, options).then(data => {\n        const end = Date.now();\n        console.log('Response %o in %d ms', data, end - startTime);\n\n        return data;\n    });\n};","export default cache => handler => (request, options) => {\n    const cacheOptions = Object.assign({\n        cache: true,\n        checkCache: true,\n        writeCache: true\n    }, options);\n\n    const key = JSON.stringify([request.method, request.params]);\n    return new Promise((resolve, reject) => {\n        if (cacheOptions.cache && cacheOptions.checkCache) {\n            const item = cache.get(key);\n            if (item) {\n                console.log('Cache hit %s', key, item);\n                resolve(item);\n\n                return;\n            }\n\n            console.log('Cache miss %s', key);\n        }\n\n        handler(request, options)\n            .then(data => {\n                if (cacheOptions.cache && cacheOptions.writeCache) {\n                    console.debug('Cache write %s', key, data);\n                    cache.set(key, data);\n                }\n                resolve(data);\n            })\n            .catch(error => reject(error));\n    });\n};\n\n","export default (handler, middlewares) => middlewares.reverse().reduce(\n    (prev, cur) => null === prev ? cur : cur(prev),\n    handler\n);\n","function InMemoryCache(restoreData) {\n    if (!(this instanceof InMemoryCache)) {\n        return new InMemoryCache(restoreData);\n    }\n\n    let data = restoreData || {};\n\n    InMemoryCache.prototype.set = (key, value) => data[key] = value;\n\n    InMemoryCache.prototype.get = key => data[key];\n\n    InMemoryCache.prototype.delete = key => delete data[key];\n\n    InMemoryCache.prototype.clear = () => data = {};\n}\n\nexport default InMemoryCache;","function LocalStorage(prefix) {\n    if (!(this instanceof LocalStorage)) {\n        return new LocalStorage(prefix);\n    }\n    prefix = prefix || '';\n    let storage = localStorage;\n\n    LocalStorage.prototype.set = (key, value) => localStorage.setItem(prefix+key, JSON.stringify(value));\n\n    LocalStorage.prototype.get = key => {\n        const item = localStorage.getItem(prefix+key);\n        if (item){\n            return JSON.parse(item);\n        }\n\n        return item;\n    };\n\n    LocalStorage.prototype.delete = key => localStorage.removeItem(prefix+key);\n\n    LocalStorage.prototype.clear = () => localStorage.clear();\n}\n\nexport default LocalStorage;","function withTTL(cache, TTL) {\n    return {\n        set: (key, value) => cache.set(key, {time: Date.now(), value: value}),\n        get: key => {\n            const item = cache.get(key);\n            if (item && item.time) {\n                if (item.time > Date.now() - TTL) {\n                    return item.value;\n                }\n\n                console.log('Cache expire.');\n\n                return null;\n            }\n\n            return item;\n        },\n        delete: key => cache.delete(key),\n        clear: () => cache.clear(),\n    };\n}\n\nexport default withTTL;","import KodiClient from './KodiClient.js';\nimport KodiClientRPC from './KodiClientRPC.js';\nimport KodiWebSocketTransport from './transport/KodiWebSocketTransport.js';\nimport KodiXMLHttpTransport from './transport/KodiXMLHttpTransport.js';\nimport LoggingNotificationMiddleware from './notificationMiddleware/logging.js';\nimport stackNotification from './notificationMiddleware/stackFactory.js';\nimport LoggingMiddleware from './middleware/logging.js';\nimport CacheMiddleware from './middleware/cache.js';\nimport stack from './middleware/stackFactory.js';\nimport InMemoryCache from './cache/InMemory.js';\nimport LocalStorageCache from './cache/LocalStorage.js';\nimport withTTL from './cache/withTTL.js';\n\nfunction getCache(options) {\n    return options.cache || window.localStorage ? new LocalStorageCache('request_') : new InMemoryCache();\n}\n\nfunction getTransport(options) {\n    let uri = options.uri;\n    if (!uri) {\n        uri = window.location;\n        uri = typeof window.WebSocket === 'function' ? `ws://${uri}:9090` : `http://${uri}:8080/jsonrpc`\n    }\n\n    if (null !== (new URL(uri)).protocol.match(/wss?:/)) {\n        return new KodiWebSocketTransport(uri);\n    }\n\n    return new KodiXMLHttpTransport(uri);\n}\n\nfunction getCacheMiddleware(options) {\n    return options.cacheMiddleware || CacheMiddleware(withTTL(getCache(options), options.TTL || 10000));\n}\n\nfunction getMiddlewares(options) {\n    return options.middlewares || [LoggingMiddleware, getCacheMiddleware(options)];\n}\n\nfunction getNotificationMiddlewares(options) {\n    return options.notificationMiddlewares || [LoggingNotificationMiddleware];\n}\n\nexport function createClientRPC(options) {\n    return new KodiClientRPC(createClient(options));\n}\n\nexport default function createClient(options) {\n    const transport = getTransport(options);\n\n    return KodiClient(\n        stack(transport.send, getMiddlewares(options)),\n        stackNotification(transport.addNotificationListener, getNotificationMiddlewares(options))\n    );\n}\n"],"names":["LocalStorageCache"],"mappings":"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"}