<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Kodi Client</title>
</head>
<body>
    <h1>Kodi Client simplify the JSONRPC request process</h1>

    <p>If Response stay empty verify your kodi configuration</p>

    <div><label>Kodi Host: <input type="text" id="host"/></label></div>

    <p>Try to call JSONRPC.Ping</br>Response was: <span id="response1"></span></p>
    <p>Try to call JSONRPC.Ping with invalid param<br/>Response was: <span id="response2"></span></p>

    <script type="text/javascript" src="src/kodi-client.js"></script>
    <script type="text/javascript">
        (function() {
            var time;
            var hostInput = document.getElementById('host');
            hostInput.value = window.location.host.split(':')[0];
            hostInput.addEventListener('input', function(){
                var that = this;
                clearTimeout(time);
                time = setTimeout(function(){
                    init(that.value);
                }, 1000);
            });

            function init(host) {
                var client = new KodiClient({
                    websocket: {
                        url: 'ws://' + host + ':9090'
                    },
                    ajax:      {
                        open: {
                            method: "POST",
                            url:    'ws://' + host + ':8080/jsonrpc'
                        }
                    }
                });

                var response1 = document.getElementById('response1');
                var response2 = document.getElementById('response2');

                client
                    .request("JSONRPC.Ping")
                    .then(function (data) {
                        response1.innerText = data;
                        response1.style.color = 'green';
                    })
                    .catch(function (data) {
                        response1.innerText = data;
                        response1.style.color = 'red';
                    });
                client
                    .request("JSONRPC.Ping", {invalidTestParam: 'foo'})
                    .then(function (data) {
                        response2.innerText = data;
                        response2.style.color = 'green';
                    })
                    .catch(function (data) {
                        response2.innerText = data;
                        response2.style.color = 'red';
                    });
            }

            init(hostInput.value);
        })();
    </script>
</body>
</html>